<!--Static files to load form Django -->
{% load staticfiles %}
<html>
<head>
<title>Dashboard - Recognize</title>

<!--custom css to override bootstrap -->
<style type="text/css">
.container {
    padding-top: 10px;
    position: inherit;
}

body { background: #f8f8f8 !important; }
body { padding-top: 0px !important; }

.row{
padding: 2px;
padding-left: 15px;
padding-right:  15px;
display: inline;
}

.panel-heading{
background: grey !important;;
}

#navbar{
background-color: grey !important;
}

.loader1 {
    position: fixed;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
    z-index: 9999;
    background: url("{%static '/images/loading.gif' %}") 50% 50% no-repeat rgb(249,249,249);
    opacity: .8;
}


#table tr {
   text-align: center;   
}

.loader2 {
    position: fixed;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
    z-index: 9999;
    background: url("{%static '/images/ajaxloader.gif' %}") 50% 50% no-repeat rgb(249,249,249);
    opacity: .8;
}



</style>

<!--Bootstrap contents to load -->
<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
<link href="{% static '/bootstrap/font-awesome/css/font-awesome.min.css' %}" rel="stylesheet" type="text/css">
<link href="{% static '/bootstrap/css/sb-admin-2.css' %}" rel="stylesheet">
<link href="{% static '/bootstrap/css/simple-sidebar.css' %}" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
     <script src="{% static '/alasql-develop/console/alasql.min.js' %}"></script>
    <script src="{% static '/alasql-develop/console/xlsx.core.min.js' %}"></script>
</head>

<!--Jquery and chartjs libraries to load -->
<script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="{% static '/chartjs/dist/Chart.bundle.js' %}"></script>
<script src="{% static '/chartjs/utils.js' %}"></script>
<script src="{% static '/bootstrap/js/jquery.js' %}"></script>
<script src="{% static '/bootstrap/js/bootstrap.min.js' %}"></script>




<body>
<script>

</script>


        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0" id="navbar">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
				
                <a class="navbar-brand" id="menu-toggle" style="color:white" href="#menu-toggle">Machine Learning - Computer Vision Library</a>
				
            </div>
            <!-- /.navbar-header -->

            <ul class="nav navbar-top-links navbar-right">
                
                <!-- /.dropdown -->
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-bell fa-fw" style="color:white"></i> <i class="fa fa-caret-down" style="color:white"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-alerts">
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-comment fa-fw"></i> New Comment
                                    <span class="pull-right text-muted small">4 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-envelope fa-fw"></i> Message Sent
                                    <span class="pull-right text-muted small">12 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-tasks fa-fw"></i> New Task
                                    <span class="pull-right text-muted small">4 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a href="#">
                                <div>
                                    <i class="fa fa-upload fa-fw"></i> Server Rebooted
                                    <span class="pull-right text-muted small">2 minutes ago</span>
                                </div>
                            </a>
                        </li>
                        <li class="divider"></li>
                        <li>
                            <a class="text-center" href="#">
                                <strong>See All Alerts</strong>
                                <i class="fa fa-angle-right"></i>
                            </a>
                        </li>
                    </ul>
                    <!-- /.dropdown-alerts -->
                </li>
                <!-- /.dropdown -->
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                        <i class="fa fa-user fa-fw" style="color:white"></i> <i class="fa fa-caret-down" style="color:white"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li><a href="#"><i class="fa fa-user fa-fw"></i> User Profile</a>
                        </li>
                        <li><a href="#"><i class="fa fa-gear fa-fw"></i> Settings</a>
                        </li>
                        <li class="divider"></li>
                        <li><a href="#"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
                        </li>
                    </ul>
                    <!-- /.dropdown-user -->
                </li>
                <!-- /.dropdown -->
            </ul>
            <!-- /.navbar-top-links -->

        </nav>

        
        

    
	<center>
	<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="well well-sm">
                <form class="form-horizontal" method="post">
						{% csrf_token %}
                    <fieldset>
                        <legend class="text-center header">Upload Image to Recognize</legend>

                        
                        <div class="form-group">
                            <span class="col-md-1 col-md-offset-2 text-center"><i class="fa fa-group bigicon"></i></span>
                            <div class="col-md-8">
                                <select id="gallery" name="gallery" type="text" class="form-control">
								<option>Personal</option>
								<option>Others</option>
								</select>
                            </div>
                        </div>

                        <div class="form-group">
                            <span class="col-md-1 col-md-offset-2 text-center"><i class="fa fa-envelope-o bigicon"></i></span>
                            <div class="col-md-8">
                                <input id="image" name="image" type="text" Placeholder="Image Path" class="form-control">
                            </div>
                        </div>

                     

                        <div class="form-group">
                            <div class="col-md-12 text-center">
                                <button type="submit" id="submit" class="btn btn-primary btn-lg">Submit</button>
                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>
    </div>
</div>
	
	
	
	 <div class="row" id="output"><!--Bootstrap grid layout to plot graph panel-->
                    
			 		
					<!-- Dynamically generating the canvas and div elements -->
					
				
     </div>
	
	 <div id="msg1"></div>
	 <div id="msg2"></div>
	 
	 
	 

	</center>	
	<div class="loader1"></div>
	
</body>

<!--Javascript code-->
<script>


	
	
//function to load gif during page load
$(window).load(function() {
    $(".loader1").fadeOut("slow");
});


//For getting CSRF token
function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}




//For doing AJAX post
 $("#submit").click(function(e) {

    e.preventDefault();

    var csrftoken = getCookie('csrftoken');

    var uname = $('#uname').val();
	
	var gallery = $('#gallery').val();
	var image = $('#image').val();
	

	
//Ajax post.details of where_to_post,what_to_post
 $.ajax({
 url : window.location.href, // the endpoint,same url
 type : "POST", // http method
 data : { csrfmiddlewaretoken : csrftoken, 
 uname : uname,
 gallery : gallery,
 image : image,
 }, // data sent with the post request
    beforeSend: function() {
                $(".loader1").show();
            },
            complete: function() {
                $(".loader1").hide();
            },

 
        // handle a successful response
        success : function(json) {
             
			
			
			console.log(json['result']);
			console.log(json['qresult']);
			
			if (json['result'] == 'success') {
			$('#msg1').html("<div class='alert alert-success'>Hi "+json['uname']+"<br />You are a "+json['gender']+"<br />You must be around "+json['age']+" years</div>");
			
			}
			else{
			$('#msg1').html("<div class='alert alert-danger'>Coudn't recognize,Sorry!...But wait<br />You are a "+json['gender']+"<br />You must be around "+json['age']+" years</div>");
			
			}
			
			
			if (json['qresult'] == 'success') {
			$('#msg2').html("<div ><table><thead><tr><th>Professional Details</th></tr></thead><tbody><tr><td>Name:</td><td>"+json['uname']+"</td></tr><tr><td>Email:</td><td>"+json['email']+"</td></tr><tr><td>Designation:</td><td>"+json['designation']+"</td></tr><tr><td>Team:</td><td>"+json['team']+"</td></tr></tbody></table></div>");
			}
			else{
			$('#msg2').html("<div class='alert alert-warning'>No Professional data found</div>");
			}
			
			
			
		
		
        },
		
	
		
		//end of chartjs 
        // handle a non-successful response
        error : function(xhr,errmsg,err) {
            console.log(xhr.status + ": " + xhr.responseText); 
			
        }
    });
	
});



</script>

</html>